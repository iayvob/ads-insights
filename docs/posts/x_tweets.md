# Twitter Posts Analytics with Twitter API (Next.js)

This doc explains how to fetch **Twitter post (tweet) analytics** such as impressions, likes, retweets, replies, and engagement via the **official Twitter API v2** using the **`twitter-api-v2` library** in a Next.js application.

---

## 1. Install Library

```bash
npm install twitter-api-v2
```

---

## 2. Initialize Client

```ts
import { TwitterApi } from 'twitter-api-v2';

const client = new TwitterApi({
  clientId: process.env.TWITTER_CLIENT_ID!,
  clientSecret: process.env.TWITTER_CLIENT_SECRET!,
});
```

---

## 3. Authentication

- Use **OAuth 2.0** with PKCE or client credentials.
- Required scopes: `tweet.read`, `users.read`.
- Flow:
  1. Redirect users to Twitter OAuth URL generated by `client.generateOAuth2AuthLink`.
  2. After login, exchange code for access token using `client.loginWithOAuth2`.
  3. Store access token securely for API calls.

---

## 4. Fetch Tweet Analytics

```ts
export async function getTweetAnalytics(accessToken: string, tweetId: string) {
  const userClient = new TwitterApi(accessToken);

  return await userClient.v2.singleTweet(tweetId, {
    'tweet.fields': ['public_metrics', 'created_at'],
  });
}
```

---

## 5. Example Next.js API Route

```ts
// pages/api/twitter/post-analytics.ts
import { getTweetAnalytics } from '../../../lib/twitter';

export default async function handler(req, res) {
  const { accessToken, tweetId } = req.body;

  try {
    const analytics = await getTweetAnalytics(accessToken, tweetId);
    res.status(200).json({ analytics });
  } catch (err: any) {
    res.status(500).json({ error: err.message });
  }
}
```

---

## 6. Example Metrics (`public_metrics`)

- `impression_count` → Number of views.
- `like_count` → Likes.
- `retweet_count` → Retweets.
- `reply_count` → Replies.
- `quote_count` → Quote tweets.

[Full Tweet Fields Reference](https://developer.twitter.com/en/docs/twitter-api/data-dictionary/object-model/tweet)

---

## Notes

- Requires Elevated Twitter Developer account.
- Rate limits apply per user and per app.
- `impression_count` is only available via **Twitter API v2**.

---

## Summary

- Use `twitter-api-v2` with OAuth 2.0.
- Call `singleTweet(tweetId, { tweet.fields: ['public_metrics'] })`.
- Get impressions, likes, retweets, replies, and quotes.
- Works cleanly inside Next.js API routes.
